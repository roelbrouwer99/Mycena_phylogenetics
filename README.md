# Phylogenetic analysis and visualization scripts

This repository contains a collection of custom scripts developed for the analysis,
comparison, and visualization of phylogenetic data, primarily in the context of
fungal systematics and molecular phylogenetics. The scripts were written by the author
with assistance from ChatGPT (OpenAI, GPT-5.x series) and were used in the context of an
academic research project.

The scripts address different aspects of phylogenetic data exploration, including
bootstrap support analysis, Bayesian tree space exploration, co-phylogenetic
visualization, alignment and tree quality assessment, and laboratory metadata
summarization.

---

## Contents

### `Bootstrap_analysis.py`
Python script to summarize and analyse bootstrap support values from phylogenetic trees.

**Functionality includes:**
- Calculation of mean bootstrap support per tree
- Summary statistics of bootstrap support distributions
- Additional bootstrap-related metrics useful for comparing alignments or inference strategies

This script was used to assess overall node support and to compare phylogenetic signal
across different datasets and analytical conditions.

---

### `Alignment_metrics.py`
Python script for the integrative visualization of alignment- and tree-based quality
metrics.

**Functionality includes:**
- Import and combination of alignment statistics (e.g. PhyKIT metrics)
- Integration of bootstrap support summaries generated by `analyze_bootstrap_support.py`
- Generation of comparative visualizations, including:
  - Scatter plots of alignment and tree metrics
  - Radar plots summarizing multidimensional dataset quality
  - Dumbbell plots for pairwise comparison of metrics across datasets or methods

This script was used to evaluate and compare the relative performance of different
alignment strategies and phylogenetic inference conditions in a visually integrative
manner.

---

### `Tree_space_metrics.R`
R script for exploring and visualizing the *tree space* of Bayesian phylogenetic analyses.

**Key features:**
- Computation of Robinson–Foulds (RF) distances among posterior trees
- Multidimensional scaling (MDS) of RF distance matrices
- Clustering of posterior trees to identify distinct topological groups
- Visualization of tree space to assess convergence and the presence of multiple
  consensus topologies

This script is intended to evaluate topological stability and heterogeneity in Bayesian
posterior tree distributions.

---

### `Tanglegram_rooted.R`
R script to generate **rooted tanglegrams** (co-phylogenies) for the comparison of
two phylogenetic trees.

**Purpose:**
- Visual comparison of congruence and conflict between rooted phylogenies
- Identification of taxa with unstable placements across analyses or datasets

---

### `Tanglegram_unrooted.R`
R script to generate **unrooted tanglegrams** for phylogenetic comparison.

**Purpose:**
- Comparison of overall tree topology without assumptions about root placement
- Useful when rooting is ambiguous or method-dependent

Together with the rooted version, these scripts facilitate detailed topological
comparisons between alternative phylogenetic hypotheses.

---

### `PCR_count.py`
Python script to summarize PCR amplification success across specimens, loci, and collection years.

**Functionality includes:**
- Counting successful DNA amplifications per locus
- Aggregation by year of specimen collection
- Generation of overview tables suitable for reporting laboratory success rates

This script was used to explore patterns in amplification success and potential effects
of specimen age or marker choice.

---

## Supporting data

### `Complete_dataset_phylogenetics.xlsx`
Tabular file containing the complete list of taxa included in the phylogenetic analyses
used in the associated study.

**Description:**
- Contains ~4000 taxa spanning all datasets included in the phylogenetic analyses
- Includes the specimen codes, specimens names, country of origin, and GenBank Accession
  numbers where available for individual samples
- Serves as a transparent record of taxon sampling and dataset composition

This file is provided here because its size exceeds what is practical to include in the
main report or supplementary materials. It enables reproducibility, re-analysis, and 
inspection of taxon sampling decisions without requiring access to the original analysis
environment.

---

### `Trees/`
Directory containing the phylogenetic trees generated and used in the analyses
presented in the associated study.

**Description:**
- Contains 14 phylogenetic trees inferred under different datasets and/or analytical conditions
- Trees are provided in PDF format
- Represents the exact tree topologies used as input for downstream analyses and visualizations

This directory is provided to document the primary phylogenetic results underlying the
analyses and to facilitate transparency, reproducibility, and re-use of the tree data
without requiring regeneration of the original inference runs.

## Requirements

Scripts in this repository use a mixture of **R** and **Python**.

Typical dependencies include:
- **R**: `ape`, `phangorn`, `cluster`, `ggplot2`, `dplyr`
- **Python**: `biopython`, `ete3`, `matplotlib`, `pandas`, `seaborn` (depending on script)

Exact package requirements may vary per script and are documented within the script
headers where applicable.

---

## License

This repository is released under the **MIT License**.
See the `LICENSE` file for details.

---

## Author

**Roel Brouwer**  
Developed as part of an academic research project in phylogenetics and fungal systematics.

---

## Notes

These scripts are research tools developed for a specific project and are provided
“as is”. While they have been tested on the datasets used in the associated study,
users are encouraged to inspect and adapt the code to their own data and research
questions. In addition to scripts, the repository includes a supporting data file 
that documents taxon inputs necessary for reproducibility.
